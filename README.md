# go-tg-bot

[![Go](https://img.shields.io/badge/go-1.25.5-blue.svg)](https://golang.org)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

Простой Telegram бот на Go, который предоставляет базовые функции для работы с Telegram API.

## Описание

go-tg-bot - это Telegram бот, который:
- Отвечает на команды `/start`, `/help`, `/dog`
- Получает случайные фотографии собак через API [random.dog](https://random.dog)
- Использует современные практики Go и чистую архитектуру

## Установка

### Предварительные требования

- Go 1.25 или выше
- Telegram Bot Token (можно получить у [@BotFather](https://t.me/BotFather))

### Шаги установки

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/kavlan-dev/go-tg-bot.git
   cd go-tg-bot
   ```

2. Установите зависимости:
   ```bash
   go mod download
   ```

3. Запустите бота:
   ```bash
   go run cmd/bot/main.go
   ```

## Использование

### Доступные команды

- `/start` - Начать работу с ботом (показывает справку)
- `/help` - Показать справку по командам
- `/dog` - Отправить случайную фотографию собаки

### Пример взаимодействия

1. Отправьте `/start` или `/help` чтобы увидеть доступные команды
2. Отправьте `/dog` чтобы получить случайную фотографию собаки
3. Бот ответит на любое текстовое сообщение эхо-ответом

## Конфигурация

Файл конфигурации находится в `config/config.yaml`:

```yaml
env: "dev" # окружение (dev или prod)
token: "YOUR_TELEGRAM_BOT_TOKEN" # токен Telegram бота
```

### Окружения

- `dev` - Режим разработки (подробное логирование)
- `prod` - Продакшн режим (структурированное логирование)

## Архитектура

Проект следует чистой архитектуре с разделение на слои:

```
├── cmd/          # Точка входа
├── config/       # Конфигурация
├── internal/
│   ├── config/   # Загрузка конфигурации
│   ├── handlers/ # Обработчики команд
│   ├── routers/  # Маршрутизация сообщений
│   ├── services/ # Бизнес-логика
│   └── utils/    # Утилиты (логгирование)
```

## Зависимости

Основные зависимости:
- [telego](https://github.com/mymmrac/telego) - Telegram Bot API wrapper
- [zap](https://github.com/uber-go/zap) - Логгирование

## Разработка

### Структура проекта

```
go-tg-bot/
├── cmd/
│   └── bot/
│       └── main.go          # Основная точка входа
├── internal/
│   ├── config/              # Конфигурация
│   ├── handlers/            # Обработчики команд
│   ├── models/              # Модели данных
│   ├── routers/             # Маршрутизация сообщений
│   ├── services/            # Сервисный слой
│   └── utils/               # Утилиты
├── .env.example             # Пример файла окружения
├── Dockerfile               # Конфигурация Docker
├── docker-compose.yml       # Конфигурация Docker Compose
├── go.mod                   # Зависимости
├── go.sum                   # Контрольные суммы зависимостей
├── LICENSE                  # Лицензия (MIT)
└── README.md                # Документация
```

### Сборка и запуск

```bash
go build ./cmd/bot
```

```bash
TOKEN=<your_token> ENV=local ./go-tg-bot
```

### Переменные окружения

- `TOKEN` - Обязательная переменная для запуска бота (токен Telegram)
- `ENV` - Необязательная переменная (по умолчанию `prod`). Доступные значения:
  - `local` - Локальный режим (аналогичен `dev`)
  - `dev` - Режим разработки (подробное логирование)
  - `prod` - Продакшн режим (структурированное логирование)

Без указания переменной `TOKEN` программа не запустится.

### Запуск через Docker

Проект можно собрать и запустить в контейнере Docker. Для этого в корне проекта находится `Dockerfile` и `docker-compose.yml`.

1. Соберите и запустите контейнер:
   ```bash
   docker-compose up -d
   ```

2. Проверьте логи:
   ```bash
   docker-compose logs -f
   ```

3. Остановите контейнер:
   ```bash
   docker-compose down
   ```

Конфигурация загружается из `.env` файла, который монтируется как том, что позволяет изменять параметры без пересборки образа.

## Лицензия

Проект распространяется под лицензией MIT. См. [LICENSE](LICENSE) для деталей.
